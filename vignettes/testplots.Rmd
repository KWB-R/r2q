---
title: "Testplots"
author: "Wolfgang Seis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Testplots}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
```{r  message=FALSE}
library(ggplot2)
library(tidyr)
# Example plot:

grid <- tidyr::expand_grid(A_E0 = 1:200, A_ba = seq(.1, 10, .1))

grid$q_zul <- 1
grid$allowed_Aba <- 1
grid$allowed_fDA <- 1

for (i in 1:nrow(grid)){
  grid$q_zul[i] <- r2q::get_q_zulaessig(A_ba = grid$A_ba[i], A_E0 = grid$A_E0[i])
  grid$allowed_Aba[i] <- r2q::get_allowed_area(q_zul = grid$q_zul[i])
  grid$allowed_fDA[i] <- r2q::get_average_runoff_coef(A_ba = grid$A_ba[i], 
                                                 q_zul = grid$q_zul[i],
                                                 R_Spende = 150)
}


ggplot(grid, aes(x = A_ba, y = A_E0, col = q_zul, fill = q_zul))+ 
  geom_tile()+ scale_color_viridis_c() + scale_fill_viridis_c() +
  xlab("befestigte Fläche [km²]") + 
  ylab("Einzugsgebietsfläche bis Einleitstelle [km²]") +
  ggtitle(bquote("Zulässige Einleitmenge" ~Q[E1][','][zul]))



```